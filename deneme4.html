<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Structural Engineer Roleplay</title>
  <style>
    .step{padding:8px 12px;border-radius:8px;background:#ccc;font-weight:bold;color:#fff}
    .step.active{background:#0077cc}
    .step.completed{background:#2ecc71}
    body{margin:0;font-family:sans-serif;background-color:#cce7f6}
    .screen{display:none;height:100vh;width:100vw;justify-content:center;align-items:center;flex-direction:column;text-align:center;padding:20px;box-sizing:border-box}
    .active{display:flex}
    canvas{border:1px solid #888;margin-top:20px}

    /* Badge bar */
    #badgeBar{min-height:48px;display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .badge-wrapper{position:relative;width:48px;height:48px}
    .badge{width:100%;height:100%;border-radius:8px;object-fit:contain;border:1px solid #e0e0e0;background:#fff;box-shadow:0 1px 2px rgba(0,0,0,.06)}
    .badge.locked{filter:grayscale(100%) opacity(.5)}
    .lock-icon{position:absolute;top:50%;left:50%;width:22px;height:22px;transform:translate(-50%,-50%);opacity:.7;pointer-events:none}

    button{margin-top:10px;padding:10px 20px;font-size:16px;border:none;border-radius:8px;background-color:#0077cc;color:#fff;cursor:pointer}
    button:hover{background-color:#005fa3}
    .hint-button{margin-left:10px;padding:2px 8px;font-size:14px}
    input,select{padding:6px;margin-top:5px;margin-bottom:10px;width:180px}

    #feedback{margin-top:20px;padding:10px;background-color:#e0f7e9;border-left:4px solid #2ecc71;display:none}
    #hintModal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.6);justify-content:center;align-items:center;z-index:1000}
    #hintModal img{max-width:90vw;max-height:80vh}
    .badge{width:60px;height:60px;margin-right:10px;display:inline-block}

    /* === NEW compact Œ≥/œà table styles === */
    .table-wrap{width:100%;overflow-x:auto}
    #loadComboCompact{width:100%;border-collapse:collapse;min-width:360px}
    #loadComboCompact th,#loadComboCompact td{padding:6px;border-bottom:1px solid #e3e3e3;text-align:center}
    #loadComboCompact thead th:first-child,
    #loadComboCompact tbody th{text-align:left;width:130px}
    #loadComboCompact select{width:64px;font-size:.9em}
    #loadComboCompact input[type="checkbox"],
    #loadComboCompact input[type="radio"]{width:18px;height:18px}
    .gamma-row{margin:10px 0;display:flex;align-items:center;gap:16px}
    .gamma-row select{width:80px}

    /* progress pills */
    .progress-step{padding:8px 12px;background:#ddd;border-radius:6px;transition:background .3s ease}
    .progress-step.completed{background:#2ecc71;color:#fff;font-weight:bold}
    
    /* NEW: Badge Notification CSS */
    @keyframes fadeInOut {
        0% { opacity: 0; }
        10% { opacity: 1; }
        90% { opacity: 1; }
        100% { opacity: 0; display: none; }
    }
  </style>
</head>
<body>
  <div id="progressBar" style="display:flex;gap:20px;margin:20px 0 40px 0;">
    <div class="step" id="step1">üîπ Intro</div>
    <div class="step" id="step2">üìè Slab</div>
    <div class="step" id="step3">üìä Loads</div>
    <div class="step" id="step4">üìê Width</div>
    <div class="step" id="step5">‚öñÔ∏è Design Load</div>
    <div class="step" id="step6">üéì Summary</div>
  </div>

  <div id="badgeBar" aria-label="Badges"
       style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;margin:-30px 20px 20px 20px;">
  </div>

  <div id="introScreen" class="screen active">
    <h1>üßë‚Äçüîß Welcome, Structural Engineer!</h1>
    <img src="./img/welcome.gif" alt="Welcome">
    <p>Your task is to design timber beams for a sustainable building project.<br>Start by entering your slab design parameters.</p>
    <button id="continueBtn">I'm Ready! ‚Üí</button>
  </div>

  <div id="canvasScreen" class="screen">
    <div style="display:flex;gap:40px;align-items:flex-start;">
      <div>
        <h2>Slab Design Parameters</h2>
        <label for="inputWidth">Width of Slab (W) (m):</label><br>
        <input type="number" id="inputWidth" step="0.1"><br>
        <label for="inputLength">Length of Slab (L) (m):</label><br>
        <input type="number" id="inputLength" step="0.1"><br>
        <label for="inputBeamCount">Number of Beams:</label><br>
        <input type="number" id="inputBeamCount" step="1" min="2"><br>
        <p id="spacingInfo" style="margin-top:10px;font-weight:bold;"></p>
        <button id="drawCanvasBtn">Visualize Design</button>
        <button id="backBtn">‚Üê Back</button>
      </div>
      <img src="./img/SlabDimensions.png" alt="Slab illustration" style="max-width:300px;">
    </div>

    <div style="display:flex;align-items:flex-start;gap:10px;margin-top:1px;">
      <canvas id="slabCanvas" width="400" height="400" style="border:1px solid #888;"></canvas>
      <div style="display:flex;flex-direction:column;align-items:center;"></div>
    </div>

    <button id="continueToLoadBtn" style="margin-top:20px;">Continue ‚Üí</button>
  </div>

  <div id="loadScreen" class="screen">
    <div style="display:flex;gap:20px;align-items:flex-start;">
      <div>
        <h2>Load & Design Factors (allows negative entry)</h2>

        <label>Permanent Load (kN/m¬≤):</label><br>
        <input type="number" id="permanentLoad" step="0.1"><br>
        <img id="imgPermanent" src="./img/load-permanent.png" alt="Permanent load" style="height:30px;display:none;"><br>

        <label>Snow Load (kN/m¬≤):</label><br>
        <input type="number" id="snowLoad" step="0.1"><br>
        <img id="imgSnow" src="./img/load-snow.png" alt="Snow load" style="height:30px;display:none;"><br>

        <label>Wind Load (kN/m¬≤):</label><br>
        <input type="number" id="windLoad" step="0.1"><br>
        <img id="imgWindPositive" src="./img/load-wind.png" alt="Wind load positive" style="height:30px;display:none;">
        <img id="imgWindNegative" src="./img/load-wind-negative.png" alt="Wind load negative" style="height:30px;display:none;"><br>

        <label>Mobile Load (kN/m¬≤):</label><br>
        <input type="number" id="mobileLoad" step="0.1"><br>
        <img id="imgMobile" src="./img/load-mobile.png" alt="Mobile load" style="height:30px;display:none;"><br>

        <div style="display:flex;flex-direction:column;align-items:center;">
          <div style="display:flex;align-items:flex-start;gap:20px;">
            <canvas id="loadCanvas" width="400" height="400" style="border:1px solid #888;"></canvas>
          </div>
        </div>

        <button id="toggleCombinedBtn" style="display:none;margin:10px;padding:10px 20px;background-color:#0066cc;color:#fff;border:none;border-radius:5px;cursor:pointer;font-size:14px;">
          Show Combined Loads
        </button>

        <div id="combinedLoadImage" style="display:none;text-align:center;margin:20px 0;"></div>
        <div id="loadImages" style="display:flex;flex-direction:column;gap:10px;margin-top:20px;align-items:center;"></div>

        <button id="backToSlabBtn">‚Üê Back to Slab</button>
        <button type="button" id="continueToTributaryBtn">Continue ‚Üí</button>
      </div>
    </div>
  </div>

  <div id="tributaryScreen" class="screen">
    <h2>Tributary Width Input</h2>

    <div style="display:flex;gap:40px;align-items:flex-start;">
      <div>
        <canvas id="loadCanvasPreview" width="400" height="400" style="border:1px solid #888;"></canvas>
        <div id="combinedImagePreview" style="text-align:center;margin-top:10px;"></div>
      </div>

      <div>
        <label for="beamSelect">Choose Beam:</label><br>
        <select id="beamSelect"></select><br><br>

        <label for="tributaryWidth">Enter Tributary Width (m):</label><br>
        <input type="number" id="tributaryWidth" step="0.1"><br><br>

        <button id="submitLoadBtn">Submit Tributary Width</button>
        <div id="feedback" style="display:none;margin-top:10px;"></div>
        <img id="feedbackGif" style="display:none;max-width:200px;margin-top:10px;">
        <div id="badgeContainer" style="margin-top:10px;"></div>

        <div id="designChecksWrapper" style="display:none;">
          <div id="checkTypeScreen" style="margin-top:20px;">
            <h3>Select Limit State</h3>

            <label><input type="checkbox" name="limitState" id="chooseSLSBtn" value="SLS"> SLS (Serviceability)</label><br>
            <label><input type="checkbox" name="limitState" id="chooseULSBtn" value="ULS"> ULS (Ultimate)</label><br>

            <p id="selectedLimitState" style="font-weight:bold;margin-top:10px;display:none;"></p>
          </div>

          <div id="loadCaseScreen" style="display:none;margin-top:20px;">
            <h3>Load combinations: pick a leading load, then set accompanying loads & factors</h3>

            <div class="gamma-row">
              <label for="gammaG"><strong>Œ≥<sub>G</sub> (permanent):</strong></label>
              <select id="gammaG"></select>

              <label for="gammaQ"><strong>Œ≥<sub>Q</sub> (variable):</strong></label>
              <select id="gammaQ"></select>
            </div>

            <div class="table-wrap">
              <table id="loadComboCompact">
                <thead>
                  <tr>
                    <th></th>
                    <th>Mobile</th>
                    <th>Wind</th>
                    <th>Snow</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>Leading</th>
                    <td><input type="radio" name="leadingAction" id="lead_mobile" value="mobile"></td>
                    <td><input type="radio" name="leadingAction" id="lead_wind"   value="wind"></td>
                    <td><input type="radio" name="leadingAction" id="lead_snow"   value="snow"></td>
                  </tr>
                  <tr>
                    <th>Accompanying</th>
                    <td><input type="checkbox" id="acc_mobile"></td>
                    <td><input type="checkbox" id="acc_wind"></td>
                    <td><input type="checkbox" id="acc_snow"></td>
                  </tr>
                  <tr>
                    <th>œà<sub>0</sub></th>
                    <td><select id="psi0_mobile"></select></td>
                    <td><select id="psi0_wind"></select></td>
                    <td><select id="psi0_snow"></select></td>
                  </tr>
                  <tr>
                    <th>œà<sub>1</sub></th>
                    <td><select id="psi1_mobile"></select></td>
                    <td><select id="psi1_wind"></select></td>
                    <td><select id="psi1_snow"></select></td>
                  </tr>
                  <tr>
                    <th>œà<sub>2</sub></th>
                    <td><select id="psi2_mobile"></select></td>
                    <td><select id="psi2_wind"></select></td>
                    <td><select id="psi2_snow"></select></td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div style="margin-top:12px;display:flex;gap:8px;align-items:center;flex-wrap:wrap;">
              <button id="saveLoadCombBtn">Save selection</button>
              <button id="hintPsiBtn" class="hint-button">‚ÑπÔ∏è View Œ® Table</button>
              <button id="hintGammaBtn" class="hint-button">‚ÑπÔ∏è View Œ≥ Table</button>
            </div>

            <div id="designLoadSectionCombo" style="display:none;margin-top:20px;">
              <h3 style="margin-top:10px;">Design Load Calculation</h3>
              <label for="designLoadInput">Enter your calculated E<sub>d</sub> (kN/m):</label>
              <input type="number" id="designLoadInput" step="0.01" style="width:150px;margin-left:10px;">
              <button id="checkDesignLoadBtn" style="margin-left:10px;">Submit Design Load</button>
              <div id="designLoadFeedback" style="display:none;margin-top:15px;padding:10px;border-left:4px solid transparent;"></div>
              <button id="continueDimensionBtnCombo" style="margin-left:10px;">Continue to Beam Cross-Section</button>
            </div>
          </div>
        </div></div>
    </div>
  </div><div id="designLoadSection" style="display:none;margin-top:30px;">
    <h4>Design Load Calculation</h4>
    <label for="designLoadInputOuter">Enter your calculated Design Load (E<sub>d</sub>) in kN/m:</label><br>
    <input type="number" id="designLoadInputOuter" step="0.01"><br><br>
    <button id="checkDesignLoadBtnOuter">Check Design Load</button>
    <div id="designLoadFeedbackOuter" style="margin-top:15px;"></div>
    </div>


    <div id="hintModal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);justify-content:center;align-items:center;">
      <div style="background:#fff;padding:10px;border-radius:5px;position:relative;">
        <span id="closeHintModal" style="position:absolute;top:5px;right:10px;cursor:pointer;">‚úñ</span>
        <img id="hintImage" src="" alt="Hint" style="max-width:90vw;max-height:90vh;">
      </div>
    </div>

  <div id="resultScreen" class="screen">
    <h2>üèÅ Final Score</h2>
    <p id="finalScore"></p>
  </div>

  <div id="mvPanel" style="display:none; margin-top:14px;">
  <h4>Maximum Internal Forces (simply supported, uniform load)</h4>
  <p style="margin:6px 0;">
    Use your verified line load <b>E<sub>d</sub></b> and span <b>L</b> (from the Slab screen):<br>
    <code>M<sub>max</sub> = w L¬≤ / 8</code> (kN¬∑m) &nbsp;&nbsp; <code>V<sub>max</sub> = w L / 2</code> (kN)
  </p>

  <div style="display:flex; gap:16px; flex-wrap:wrap; align-items:flex-end;">
    <label>M<sub>max</sub> (kN¬∑m)<br>
      <input type="number" id="mMaxInput" step="0.01" style="width:180px;">
    </label>

    <label>V<sub>max</sub> (kN)<br>
      <input type="number" id="vMaxInput" step="0.01" style="width:180px;">
    </label>

    <button id="checkMvBtn">Check M & V</button>
  </div>

  <div id="mvFeedback" style="margin-top:8px;"></div>

  <button id="continueToSummaryBtn" style="margin-top:10px;" disabled>
    Finish ‚Üí Summary
  </button>
</div>

  <div id="badgeNotification" 
       style="display:none; 
              position:fixed; 
              top:50%; 
              left:50%; 
              transform:translate(-50%, -50%); 
              padding:20px 40px; 
              background-color:rgba(0, 119, 204, 0.9); 
              color:white; 
              border-radius:10px; 
              z-index:2000; 
              box-shadow:0 5px 15px rgba(0,0,0,0.3); 
              font-size:1.5em; 
              font-weight:bold;">
      </div>


  <audio id="clickSound" src="./sounds/click.mp3" preload="auto"></audio>
  <audio id="successSound" src="./sounds/success.wav" preload="auto"></audio>
  <audio id="errorSound" src="./sounds/error.wav" preload="auto"></audio>
  <audio id="badgeSound" src="./sounds/badge.mp3" preload="auto"></audio>

  <script src="deneme4.js"></script>
</body>
</html>